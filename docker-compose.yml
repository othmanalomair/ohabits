      - "traefik.http.routers.waqti.entrypoints=websecure"
      - "traefik.http.routers.waqti.tls=true"
      - "traefik.http.routers.waqti.tls.certresolver=myresolver"
      - "traefik.http.services.waqti.loadbalancer.server.port=8080"
    depends_on:
      - postgres

  tinderbox:
    image: apps_tinderbox:latest
    networks:
      - ohabits
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
    labels:
      - "traefik.enable=true"
      # HTTP router (redirects to HTTPS)
      - "traefik.http.routers.tinderbox-http.rule=Host(`tinderboxkw.com`) || Host(`www.tinderboxkw.com`)"
      - "traefik.http.routers.tinderbox-http.entrypoints=web"
      - "traefik.http.routers.tinderbox-http.middlewares=redirect-to-https"
      # HTTPS router
      - "traefik.http.routers.tinderbox.rule=Host(`tinderboxkw.com`) || Host(`www.tinderboxkw.com`)"
      - "traefik.http.routers.tinderbox.entrypoints=websecure"
      - "traefik.http.routers.tinderbox.tls=true"
      - "traefik.http.routers.tinderbox.tls.certresolver=myresolver"
      - "traefik.http.services.tinderbox.loadbalancer.server.port=8080"

  lamma:
    image: apps_lamma:latest
    environment:
      DB_HOST: postgres
      DB_PORT: 5432
      DB_USER: most3mr
      DB_PASSWORD: 50998577
      DB_NAME: lamma
      PORT: 3000
      TZ: Asia/Kuwait
    volumes:
      - lamma_uploads:/root/uploads
    networks:
      - ohabits
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure
    labels:
      - "traefik.enable=true"
      # HTTP router (redirects to HTTPS)
      - "traefik.http.routers.lamma-http.rule=Host(`lamma.most3mr.com`)"
      - "traefik.http.routers.lamma-http.entrypoints=web"
      - "traefik.http.routers.lamma-http.middlewares=redirect-to-https"
      # HTTPS router
      - "traefik.http.routers.lamma.rule=Host(`lamma.most3mr.com`)"
      - "traefik.http.routers.lamma.entrypoints=websecure"
      - "traefik.http.routers.lamma.tls=true"
      - "traefik.http.routers.lamma.tls.certresolver=myresolver"
      - "traefik.http.services.lamma.loadbalancer.server.port=3000"
    depends_on:
      - postgres

networks:
  ohabits:
    driver: overlay

volumes:
  postgres_data:
  waqti_uploads:
  waqti_profile_uploads:
  lamma_uploads:

          